<!DOCTYPE HTML>
<html>
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Ajax Example</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
        <ul id="info1">
                <li>Wellforgo PDF & ExcelDownload</li>
        </ul>
        <form id="form1">
                <input type="text" name="field1" id="field1">
                <input type="button" name="submit" id="pdf" value="PDF">
				<input type="button" name="submit" id="excel" value="Excel">
        </form>
		
        <script>
            
        $('#pdf').click(function(event) {
				console.log("Testing-PDF");
				var excelData=getJsonData();
                event.preventDefault();
               $.ajax({
						xhrFields: {
							responseType: 'blob' 
						},
						type: 'POST',
                        url: 'http://localhost/api/pdf',
                        data: excelData,
                        success: function (result) {
								let blob = new Blob([result], { type: "application/octetstream" }); 
								let a = document.createElement('a');
								a.href = window.URL.createObjectURL(blob);
								a.download = "wellforgo.pdf";
								document.body.appendChild(a);
								a.click();
								document.body.removeChild(a);
								window.URL.revokeObjectURL(a.href);
                        }
                });
        });
		
		 $('#excel').click(function(event) {
            console.log("Testing-EXCEL");
				var excelData=getJsonData();
                event.preventDefault();
                $.ajax({
						xhrFields: {
							responseType: 'blob' // to avoid binary data being mangled on charset conversion
						},
						type: 'POST',
                        url: 'http://localhost/api/excel',
                        data: excelData,
                        success: function (result) {
								let blob = new Blob([result], { type: "application/octetstream" }); 
								let a = document.createElement('a');
								a.href = window.URL.createObjectURL(blob);
								a.download = "wellforgo.xlsx";
								document.body.appendChild(a);
								a.click();
								document.body.removeChild(a);
								window.URL.revokeObjectURL(a.href);
                        }
                });
        });
		
 function getJsonData()
 {
   var jsonObj={
    "mainTitle": "Wells Fargo Quote Form for HVAC Projects",
    "tableOneTitle": "PROJECT/ WO INFORMATION (Information provided by Wells Fargo)",
    "tableTwoTitle": "VENDOR'S AUTHORIZED REPRESENTATIVE",
    "dateSubmitted": "XXXXX",
    "projectOrWorkOrder":  "XXXXX",
    "wfProjectOrPropertyManager":  "XXXXX",
    "beNumber":  "XXXXX",
    "buildingOrProjectName":  "XXXXX",
    "beServiceOrDeliveryAddress": "XXXXX",
    "projectArea": "XXXXX",
    "estimatedStartDate": "XXXXX",
    "estimatedCompleteDate": "XXXXX",
    "companyName": "Lynxspring Inc",
    "remitToAddress": "2900 NE Independence Ave",
    "cityStateZip": "Lee's Summit, MO 64086",
    "contactName": "XXXXX",
    "phone": "816 347 3500",
    "cell": "913 219 5513",
    "email": "XXXXX",
    "wfVendOrNumber": "XXXXX",
    "proposalNumber": "XXXXX",
    "wfContractNumber": "XXXXX",
    "changeOrder": "XXXXX",
    "changeOrderPreviousPO": "XXXXX",
    "scopeTitle": "SCOPE OF WORK",
    "scopeSubHeadOne": "Detail Needed- Be as descriptive as possible and if there are multiples of items please specify how many.  Details and numbers of units help fixed assets determine asset value and will help eliminate questions and the need to resubmit proposals or invoices. ",
    "scopeSubDescription": "Provide JENEsys Hardware as submitted by Wells Fargo on JENE order forms.  Pre-Mount equipment in v 2.54 Admin Panels and ship to site for Site Electrical/BMS Contractor to Install. Site Contractor responsible to provide on site integration, graphics, schedules, alarms and configuration.  Station to be returned to Lynxspring for review.  BExxx Site to have xxxxxxxxxxx.",
    "scopeSubDescription_D1": "Provide JENEsys Hardware as submitted by Wells Fargo on JENE order forms.  Pre-Mount equipment in v 2.54 Admin Panels and ship to site for Site Electrical/BMS Contractor to Install. Site Contractor responsible to provide on site integration, graphics, schedules, alarms and configuration.  Station to be returned to Lynxspring for review.",
    "scopeSubDescription_D2": "BExxx Site to have xxxxxxxxxxx.",
    "installHeading": "INSTALLATION",
    "detailSubHeadOne": "DETAILED DESCRIPTION",
    "productSubHeadTwo": "PRODUCT / MATERIAL / EQUIPMENT",
    "laborSubHeadThree": "LABOR / SERVICE",
    "installHeadingColumn1": "WF needs to see the Labor Costs associated with the Product.  If Quote is for labor only, leave Product Section blank.  Include separate lines for HVAC components as well  as separate lines for equipent and materials related to that component.Include separate lines for controls components (i.e. controller devices such as JENEsys, thermostats, miscellaneous materials). Include labor associated with specific equipment on the same line.",
    "installHeadingColumn1_D1": "WF needs to see the Labor Costs associated with the Product.  If Quote is for labor only, leave Product Section blank.",
    "installHeadingColumn1_D2": "Include separate lines for HVAC components as well  as separate lines for equipent and materials related to that component.\n\n",
    "installHeadingColumn1_D3": "Include separate lines for controls components (i.e. controller devices such as JENEsys, thermostats, miscellaneous materials). Include labor associated with specific equipment on the same line.",
    "installHeadingColumn2": "Manufacturer",
    "installHeadingColumn3": "Model #",
    "installHeadingColumn4": "Serial # (if available)",
    "installHeadingColumn5": "Qty.",
    "installHeadingColumn6": "Each Price ",
    "installHeadingColumn7": "Each Mark-Up",
    "installHeadingColumn8": "TOTAL PRODUCT",
    "installHeadingColumn9": "Taxable? (Y/N)",
    "installHeadingColumn10": "# People",
    "installHeadingColumn11": "# Hours per Person",
    "installHeadingColumn12": "Hourly Bill Rate",
    "installHeadingColumn13": "Union Rate(Y/N)",
    "installHeadingColumn14": "TOTAL LABOR",
    "installHeadingColumn15": "Labor Taxable? (Y/N)",
    "installHeadingColumn16": "TOTAL PRODUCT & LABOR",
    "installColumns": [],
	
    "totalProduct": "$ -",
    "totalPeople": "0",
    "totalHoursPerPerson": "0",
    "totalHourlyBillRate": "xxxxx",
    "totalUnionRate": "xxxxx",
    "totalLabor": "$ -",
    "totalLaborTaxable": "xxxxx",
    "totalProductAndLabor": "$ -",
	
    "demoHeading": "DEMO / REMOVAL / PATCHING / REPAIRS / RELO ",
    "demoSubHeadOne": "DEMO - PRODUCT/ MATERIALS",
    "demoSubHeadTwo": "DEMO - LABOR",
    "demoHeadingColumn1": "Include costs of demolition and demolition labor.",
    "demoHeadingColumn2": "",
    "demoHeadingColumn3": "",
    "demoHeadingColumn4": "Qty.",
    "demoHeadingColumn5": "Price Each",
    "demoHeadingColumn6": "TOTAL DEMO",
    "demoHeadingColumn7": "Taxable? (Y/N)",
    "demoHeadingColumn8": "# People",
    "demoHeadingColumn9": "# Hours per Person",
    "demoHeadingColumn10": "Hourly Bill Rate",
    "demoHeadingColumn11": "Union Rate(Y/N)",
    "demoHeadingColumn12": "TOTAL LABOR",
    "demoHeadingColumn13": "Labor Taxable? (Y/N)",
    "demoHeadingColumn14": "TOTAL DEMO PRODUCT & LABOR",
    "demoColumns": [],
    "totalDemo": "$ -",
    "totalDemoPeople": "0",
    "totalDemoHoursPerPerson": "0",
    "totalDemoHourlyBillRate": "xxxxx",
    "totalDemoUnionRate": "xxxxx",
    "totalDemoLabor": "$ -",
    "totalDemoLaborTaxable": "xxxxx",
    "totalDemoProductAndLabor": "$ -",
    "clarificationsHeading": "Assumptions and Clarifications ",
    "clarificationDescription": " Assumes local contractor will integrate all existing devices and complete all necessary graphics.",
    "taxHeading": "Manually Insert Tax $ as required",
    "taxHeadingColoumn1": "ENTER TAX RATE ",
    "taxHeadingColoumn2": "PRE-TAX",
    "taxHeadingColoumn3": "TAX",
    "totalTaxHeading": "TOTAL",
    "taxRate": "0.00% ",
    "product": "PRODUCT  ",
    "productPreTax": "$   - ",
    "productTax": "$   - ",
    "productTotal": "$   - ",
    "labor": "LABOR  ",
    "laborPreTax": "$   - ",
    "laborTax": "$   - ",
    "laborTotal": "$   - ",
    "subTotal1": "SUBTOTAL  ",
    "subTotal1PreTax": "$   - ",
    "subTotal1Tax": "$   - ",
    "subTotal1Total": "$   -",
    "demoProduct": "DEMO PRODUCT  ",
    "demoProductPreTax": "$   - ",
    "demoProductTax": "$   - ",
    "demoProductTotal": "$   - ",
    "demoLabor": "DEMO LABOR  ",
    "demoLaborPreTax": "$   - ",
    "demoLaborTax": "$   - ",
    "demoLaborTotal": "$   -",
    "subTotal2": "SUBTOTAL  ",
    "subTotal2PreTax": "$   - ",
    "subTotal2Tax": "$   - ",
    "subTotal2Total": "$   - ",
    "freight": "FREIGHT  ",
    "freightPreTax": "$   - ",
    "freightTax": "$   - ",
    "freightTotal": "$   - ",
    "shipping": "SHIPPING & HANDLING  ",
    "shippingPreTax": "$   - ",
    "shippingTax": "$   - ",
    "shippingTotal": "$   - ",
    "profit": "PROFIT & OH  ",
    "profitPreTax": "$   - ",
    "profitTax": "$   - ",
    "profitTotal": "$   -",
    "insurance": "INSURANCE  ",
    "insurancePreTax": "$   - ",
    "insuranceTax": "$   - ",
    "insuranceTotal": "$   - ",
    "allTotal": "TOTAL  ",
    "allTotalTaxPreTax": "$   - ",
    "allTotalTax": "$   - ",
    "allMaterialTotal": "$   - ",
    "rotationText": "if \n applicable"
}
var installationTable=[]; 
 installationTable.push({
	"coloumn1": "Detailed Description",
	"coloumn2": "XXXXX",
	"coloumn3": "XXXXX",
	"coloumn4": "XXXXX",
	"coloumn5": "XXXXX",
	"coloumn6": "XXXXX",
	"coloumn7": "$  - ",
	"coloumn8": "$  - ",
	"coloumn9": "Y",
	"coloumn10": "XXXXX",
	"coloumn11": "XXXXX",
	"coloumn12": "XXXXX",
	"coloumn13": "Y",
	"coloumn14": "$  - ",
	"coloumn15": "Y",
	"coloumn16": "$  - "
  });
jsonObj.installColumns=installationTable;

var demoTable=[];

demoTable.push({
  "coloumn1": "",
  "coloumn2": "",
  "coloumn3": "",
  "coloumn4": "",
  "coloumn5": "$    -",
  "coloumn6": "$    -",
  "coloumn7": "",
  "coloumn8": "",
  "coloumn9": "",
  "coloumn10": "$    -",
  "coloumn11": "",
  "coloumn12": "$    -",
  "coloumn13": "",
  "coloumn14": "$    -"
})
jsonObj.demoColumns=demoTable;
return jsonObj;

 }
        </script>
</body>
</html>